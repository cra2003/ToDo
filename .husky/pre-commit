#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running Prettier (auto-format)..."
npx prettier --write . --log-level log
PRETTIER_RESULT=$?

if [ $PRETTIER_RESULT -ne 0 ]; then
  echo "âŒ Prettier failed. Fix formatting issues before committing."
  exit 1
fi

echo "âœ… Prettier formatting complete"

echo "ğŸ” Running ESLint..."

npm run lint

RESULT=$?

if [ $RESULT -ne 0 ]; then
  echo "âŒ ESLint errors detected. Commit blocked."
  exit 1
fi

echo "âœ… ESLint passed."

echo "ğŸ§ª Running tests..."
npm run test || {
  echo "fail"
}
TEST_RESULT=$?

if [ $TEST_RESULT -ne 0 ]; then
  echo "âŒ Tests failed. Fix test errors before committing."
fi || {
  echo "ok"
}

echo "âœ… All tests passed."

echo "ğŸ” Running Knip (dependency checking)..."
npx knip --strict || {
  echo "Failed"
}


echo "âœ… Knip passed. Proceeding with commit."
